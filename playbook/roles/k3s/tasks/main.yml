- name: Setup K3S Server
  script: files/setup.sh
  when: inventory_hostname in groups[group]

- name: Setup K3S CNI
  script: files/setup-cni-kubeovn.sh {{ ingress_ip }}
  when: inventory_hostname in groups[group]

- name: Setup K3S Ingress
  script: files/setup-ingress-apisix-controller.sh {{ ingress_ip }}
  when: inventory_hostname in groups[group]

#- name: Setup Egress
#  script: files/setup-egress.sh {{ egress_ip }} {{ namespace }}
#  when: inventory_hostname in groups[group]

- name: Setup DNS Provider
  script: files/setup-dns-provider.sh {{ dns_ak }}  {{ dns_sk }}
  when: inventory_hostname in groups[group]
